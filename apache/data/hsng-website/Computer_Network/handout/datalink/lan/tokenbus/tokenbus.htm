<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
   <TITLE>Untitled</TITLE>
   <META NAME="GENERATOR" CONTENT="Mozilla/3.0Gold (Win95; I) [Netscape]">
</HEAD>
<BODY BACKGROUND="../../../gif/bg-slate.gif">

<P><FONT COLOR="#0080FF"><FONT SIZE=+3>Token Bus 網路</FONT></FONT></P>

<P><FONT COLOR="#FF0000"><FONT SIZE=+2>網路特性</FONT></FONT><FONT SIZE=+1>
</FONT></P>

<UL>
<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>實際連線方式是bus，邏輯的運作上是ring
</FONT></P>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>利用Token控制資料傳送秩序(沒有碰撞)
</FONT></P>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>利用軟體維護邏輯環架構</FONT></P>

<P><IMG SRC="tokenbus.gif" HEIGHT=363 WIDTH=552></P>
</UL>

<P><BR>
<IMG SRC="../../../gif/bar.gif" HEIGHT=20 WIDTH=600></P>

<P><FONT COLOR="#FF0000"><FONT SIZE=+2>MAC格式 </FONT></FONT></P>

<UL>
<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>資料格式</FONT><BR>
</P>
</UL>

<P><IMG SRC="tokenbusframe.gif" HEIGHT=87 WIDTH=593><BR>
</P>

<UL>
<UL>
<P><FONT SIZE=+1>SD = State Delimiter (資料開始) <BR>
FC = Frame Control (控制欄) <BR>
DA = Destination Address (目的地位址) <BR>
SA = Source Address (送出者位址) <BR>
FCS = Frame Check Sequence (資料檢查碼) <BR>
ED = End Delimiter (資料結束) </FONT><BR>
</P>
</UL>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>控制資料(以FC欄辨識)
</FONT></P>

<UL>
<P><IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14><FONT SIZE=+1>claim
token <BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14>solicit
successor <BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14>who
follows <BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14>resolve
contention <BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14>token
<BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14>set
successor <BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14>LLL
MAC data format </FONT></P>
</UL>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>反應時窗
</FONT></P>

<UL>
<P><IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14><FONT SIZE=+1>round
trip propagation delay <BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14>one
slot time</FONT><BR>
</P>
</UL>
</UL>

<P><IMG SRC="../../../gif/bar.gif" HEIGHT=20 WIDTH=600></P>

<P><FONT COLOR="#FF0000"><FONT SIZE=+2>信物運作原理</FONT></FONT><FONT SIZE=+1>
</FONT></P>

<UL>
<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>工作站收到信物後，可以傳送資料，傳完再將信物送給下一工作站
</FONT></P>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>邏輯環是依工作站ID依序連接(由大到小)
</FONT></P>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>每一工作站知道自己(TS)，前一站(PS)，及後一站(NS)之ID
</FONT></P>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>每一工作站保有信物的時間限制：token
holding timer </FONT></P>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>工作站拿到信物後，不可不傳資料也不送出信物
</FONT></P>

<P><IMG SRC="tokenbus2.gif" HEIGHT=270 WIDTH=552></P>
</UL>

<P><IMG SRC="../../../gif/bar.gif" HEIGHT=20 WIDTH=600></P>

<P><FONT COLOR="#FF0000"><FONT SIZE=+2>加入工作站程序</FONT></FONT><FONT SIZE=+1>
</FONT></P>

<UL>
<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>信物持有者送出Solicit-successor-1
(DA=NS , SA=TS) </FONT></P>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>凡欲加入者，如果其ID介於DA與SA間，則送出set-successor<BR>
　(DA=Token holder , SA=TS , DATA=TS) </FONT></P>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>信物持有者根據在一個反應時間內之反應而採適當動作
</FONT></P>

<UL>
<P><IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14><FONT SIZE=+1>沒有反應：送信物給下一站
<BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14>唯一反應：讓此工作站加入(修改信物持有者，下一站，及新加<BR>
　　　　　　入者之NS , PS) <BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14>多重反應：
</FONT></P>

<UL>
<P><IMG SRC="../../../gif/redcube.gif" HEIGHT=18 WIDTH=18><FONT SIZE=+1>送出resolve-contention
<BR>
<IMG SRC="../../../gif/redcube.gif" HEIGHT=18 WIDTH=18>等待四個反應時窗：欲加入者依其最左邊2
bit決定在哪一<BR>
　時窗送回set successor。若前面時窗已有人送，則放棄 <BR>
<IMG SRC="../../../gif/redcube.gif" HEIGHT=18 WIDTH=18>若仍未能解決爭端，再等四個反應時窗。此次看下二個bit<BR>
　決定何時送回 <BR>
<IMG SRC="../../../gif/redcube.gif" HEIGHT=18 WIDTH=18>重複此步驟直至問題解決
</FONT></P>
</UL>
</UL>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>如果信物持有者的ID是ring中最小者，送solicit-successor-2
</FONT></P>

<UL>
<P><IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14><FONT SIZE=+1>等待2個反應時窗：欲加入之工作站ID比信物持有者小的，在第<BR>
　一時窗送回set successor。比最大ID還大的，在第二時窗送回。<BR>
　若有多重反應依上述方法解決 </FONT></P>
</UL>
</UL>

<P><IMG SRC="../../../gif/bar.gif" HEIGHT=20 WIDTH=600></P>

<P><FONT COLOR="#FF0000"><FONT SIZE=+2>工作站退出程序</FONT></FONT><FONT SIZE=+1>
</FONT></P>

<UL>
<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>工作站取得信物後，送出set
successor (DA=PS , SA=TS , DATA=NS) </FONT></P>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>送信物給下一站</FONT></P>

<P><IMG SRC="tokenbusdel1.gif" HEIGHT=266 WIDTH=552></P>

<P><IMG SRC="tokenbusdel2.gif" HEIGHT=266 WIDTH=578></P>
</UL>

<P><IMG SRC="../../../gif/bar.gif" HEIGHT=20 WIDTH=600></P>

<P><FONT COLOR="#FF0000"><FONT SIZE=+2>錯誤處理程序 </FONT></FONT></P>

<UL>
<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>多重信物
</FONT></P>

<UL>
<P><IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14><FONT SIZE=+1>原因：干擾或ID重複
<BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14>偵測方法：當某一工作站拿到信物時，卻聽到有其他工作站在傳<BR>
　　　　　　送資料 <BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14>解決方法：放棄信物，造成無信物狀態
</FONT></P>
</UL>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>下一站沒有收到信物
</FONT></P>

<UL>
<P><IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14><FONT SIZE=+1>原因：干擾，或工作站損壞
<BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14>偵測：在一反應時窗內沒有收到資料或信物
<BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14>解決：原信物持有者再送一次信物，若仍沒反應表示下一站損壞<BR>
　　　　。送出who-follows (DA=XX , SA=TS , DATA=NS)如果某<BR>
　　　　一工作站的PS為此一損壞之工作站，則送回set successor </FONT></P>

<P><FONT COLOR="#FF0000"><FONT SIZE=+1>假設 station 50 failed</FONT></FONT></P>

<P><IMG SRC="tokenbusfail1.gif" HEIGHT=266 WIDTH=552></P>

<P><IMG SRC="tokenbusfail2.gif" HEIGHT=266 WIDTH=552><BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14><FONT SIZE=+1>多重損壞：
</FONT></P>

<UL>
<P><FONT SIZE=+1>1.若在三個反應時窗內仍沒有人回set successor，則再試一次<BR>
　who follows。若再失敗，則表示多重損壞，須重建邏輯環<BR>
　架構 <BR>
2.送出solicit successor 2 (DA=SA=TS)，等二個反應時窗 <BR>
3. ID小於此工作站者，在第一時窗回set successor。ID大者，<BR>
　則在第二時窗回 <BR>
4.爭端由resolve-contention解決 <BR>
5.此後依加入工作站程序重建 <BR>
6.如果solicit-successor-2仍沒有人回，則表示其他工作站均損<BR>
<FONT COLOR="#FF0000">　</FONT><FONT COLOR="#000000">壞或本身接收器故障</FONT><FONT COLOR="#FF0000">
</FONT></FONT></P>
</UL>

<P><FONT COLOR="#FF0000"><FONT SIZE=+1>假設 station 50 和 station 30 failed</FONT></FONT></P>

<P><IMG SRC="tokenbusfail3.gif" HEIGHT=272 WIDTH=552></P>

<P><IMG SRC="tokenbusfail4.gif" HEIGHT=272 WIDTH=552></P>
</UL>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>沒有信物
</FONT></P>

<UL>
<P><IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14><FONT SIZE=+1>原因：token
holder損壞，token損壞，起始狀態 <BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14>偵測：在一段bus
idler timer時間內均沒有任何訊息 <BR>
<IMG SRC="../../../gif/orangeba.gif" HEIGHT=14 WIDTH=14>解決：
</FONT></P>

<UL>
<P><FONT SIZE=+1>1.送出Claim token，資料長度依ID最左邊2bit決定 <BR>
2.如果沒有衝撞，表示是唯一發現者，成為信物持有者 <BR>
3.如果發生衝撞 </FONT></P>

<UL>
<LI><FONT SIZE=+1>最後時槽沒有衝撞：ID最大，成為信物持有者 </FONT></LI>

<LI><FONT SIZE=+1>全部衝撞且後面還有訊息：ID不是最大，放棄競爭 </FONT></LI>

<LI><FONT SIZE=+1>全部衝撞且後面沒有訊息：無法分別大小，再送一次<BR>
　　　　　　　　　　　　Claim token，資料長度依<BR>
　　　　　　　　　　　　次2 bit決定 </FONT></LI>

<LI><FONT SIZE=+1>重複直到有信物持有者產生 </FONT></LI>
</UL>
</UL>
</UL>
</UL>

<P><IMG SRC="../../../gif/bar.gif" HEIGHT=20 WIDTH=600></P>

<P><FONT COLOR="#FF0000"><FONT SIZE=+2>優先權</FONT></FONT><FONT SIZE=+1>
</FONT></P>

<UL>
<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>FC中有三個位元之優先權，但只採四等級：0
, 2 , 4 , 6 </FONT></P>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>最高等級傳送時間限制：HPTHT
</FONT></P>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>每次拿到信物均可傳送最高等級之資料。其他等級則依Token
Rotation<BR>
　Time (TRT)決定。(TRT4 , TRT2 , TRT0) </FONT></P>

<UL>
<UL>
<P><IMG SRC="priority.gif" HEIGHT=232 WIDTH=380></P>
</UL>
</UL>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>演算法：</FONT></P>

<UL>
<P><FONT COLOR="#FF0000"><FONT SIZE=+1>General Priority Algorithm</FONT></FONT></P>

<UL>
<P><IMG SRC="tokenbusalgo.gif" HEIGHT=705 WIDTH=348></P>

<P><FONT COLOR="#FF0000"><FONT SIZE=+1>Token Bus Priority Algorithm</FONT></FONT></P>

<P><IMG SRC="tokenbusalgo1.gif" HEIGHT=645 WIDTH=430></P>
</UL>
</UL>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>例子：</FONT></P>

<P><IMG SRC="tokenbusex.gif" HEIGHT=344 WIDTH=582></P>
</UL>

<P><IMG SRC="../../../gif/bar.gif" HEIGHT=20 WIDTH=600></P>

<P><FONT COLOR="#FF0000"><FONT SIZE=+2>編碼技巧</FONT></FONT><FONT SIZE=+1>
</FONT></P>

<UL>
<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>差動式曼撤斯特編碼</FONT></P>

<P><IMG SRC="diffmanch1.gif" HEIGHT=344 WIDTH=436></P>

<P><IMG SRC="diffmanch2.gif" HEIGHT=344 WIDTH=458></P>
</UL>

<P><IMG SRC="../../../gif/bar.gif" HEIGHT=20 WIDTH=600></P>

<P><FONT COLOR="#FF0000"><FONT SIZE=+2>ARCnet </FONT></FONT></P>

<UL>
<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>LANTECH公司產品
</FONT></P>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>2.5Mbps
</FONT></P>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>使用同軸電纜或雙絞線
</FONT></P>

<P><IMG SRC="../../../gif/gr_diam.gif" HEIGHT=19 WIDTH=19><FONT SIZE=+1>架構類似1Base5
</FONT></P>

<UL>
<UL>
<UL>
<UL>
<UL>
<P><A HREF="javascript:history.go(-1)"><IMG SRC="../../../gif/goup.jpg" BORDER=0 HEIGHT=55 WIDTH=136></A><BR>
</P>
</UL>
</UL>
</UL>
</UL>
</UL>
</UL>

</BODY>
</HTML>
